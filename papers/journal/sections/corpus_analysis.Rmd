# Corpus Analysis
```{r corpus-data}
# Plot of Referential Communication from LDP Corpus Data
corpus_data <- read_feather(here("data/coded_responses.feather")) %>%
  mutate(freq_cut = cut(log(freq), 10))%>%
  separate(freq_cut, into = c("freq_cut_left", "freq_cut_right"), sep = ",",
           remove = FALSE) %>%
  mutate(freq_cut_left = as.numeric(str_remove_all(freq_cut_left,"\\(")),
         freq_cut_right = as.numeric(str_remove_all(freq_cut_right,"\\]")),
         freq_cut = (freq_cut_left + freq_cut_right)/2) %>%
  select(-freq_cut_left, -freq_cut_right)

modality_data <- corpus_data %>%
  group_by(person, age, subj, freq_cut, rank, freq, referent, modality, chat) %>%
  summarise(n = n()) %>%
  spread(modality, n, fill = 0)
```

We first investigate parent referential communication in a longitudinal corpus of parent-child interaction. We analyze the production of ostensive labeling (i.e. using both gesture and speech) to refer to the same object in the same instance. While many aspects of child-directed speech support learning, ostensive labeling (e.g., speaking while pointing or looking) is a particularly powerful source of data for young children [e.g., @baldwin2000; @gogate2000]. We take the ostensive labeling produced by multi-modal cues to be a case-study phenomenon of pedagogically supportive language input. While our account should hold for other language phenomena, by focusing on one phenomenon we attempt to specify the dynamics involved in the production of such input.

In this analysis of naturalistic communication, we examine the prevalence of ostensive labeling in children's language environment at different ages. We find that this pedagogically-supportive form of input shows a key halmark of adaptive tuning: caregivers using this information-rich cue more for young children and infrequent objects. Thus, parents production of ostensive labeling is tuned to children's developing linguistic knowledge [@yurovsky2016]. 

## Methods

We used data from the Language Development Project--a large-scale, longitudinal corpus of naturalistic parent child-interaction in the home [@goldin-meadow2014]. The Language Development Project corpus contains transcription of all speech and communicative gestures produced by children and their caregivers over the course of the 90-minute home recordings. We coded each of these communicative instances to identify each time a concrete noun was referenced using speech, gesture, or both in the same referential expression (so called ostenstive labeling). In these analyses, we focus only caregivers' productions of ostenstive labeling in the form of a multi-modal reference.


### Participants

The Language Development Project aimed to recruit a sample of families who are representative of the Chicago community in socio-economic and racial diversity [@goldin-meadow2014]. These data are drawn from a subsample of 10 families from the larger corpus. Our subsample contains data taken in the home every 4-months from when the child was 14-months-old until they were 34-months-old, resulting in 6 timepoints (missing one family at the 30-month timepoint). Recordings were 90 minute sessions, and participants were given no instructions.

Of the ten target children, five were girls, three were Black and two were Mixed-Race. Families spanned a broad range of incomes, with two families earning \$15,000 to \$34,999 and 1 family earning greater than \$100,000. The median family income was \$50,000 to \$74,999.

### Procedure

From the extant transcription and gesture coding, we specifically coded all concrete noun referents produced in either the spoken or gestural modality (or both). Spoken reference was coded only when a specific noun form was used (e.g., "ball"), to exclude pronouns and anaphoric usages (e.g., "it"). Gesture reference was coded only for deictic gestures (e.g., pointing to or holding an object) to minimize ambiguity in determining the intended referent. In order to fairly compare rates of communication across modalities, we need to examine concepts that can be referred to in either gesture or speech (or both) with similar ease. Because abstract entities are difficult to gesture about using deictic gestures, we coded only on references to concrete nouns. 

### Reliability

To establish the reliability of the referent coding, 25% of the transcripts were double-coded. Inter-rater reliability was sufficiently high (Cohenâ€™s $\kappa$ = 0.76). Disagreements in coding decisions were discussed and resolved by hand.

To ensure that our each referent could potentially be referred to in gesture or speech, we focused on concrete nouns. We further wanted to ensure that the referents were physically present in the scene (and thus accessible to deictic gestures). Using the transcripts, a human rater judged whether the referent was likely to be present, primarily relying on discourse context (e.g., a referent was coded as present if the deictic gesture is used or used at another timepoint for the reference, or if the utterance included demonstratives such as "This is an X"). A full description of the coding criteria can be found in the Supporting Materials.

To ensure our transcript-based coding of referent presence was sufficiently accurate, a subset of the transcripts (5%) were directly compared to corresponding video data observation. Reliability across the video data and the transcript coding was sufficiently high ($\kappa$ = 0.72). Based on transcript coding of all the referential communication about concrete nouns, 90% of the references were judged to be about referents that were likely present. All references are included in our dataset for further analysis.

## Results

```{r corpus-plot-lm}
mid_age <- modality_data %>% 
  pull(age) %>%
  unique() %>% 
  mean() %>%
  log()

mid_freq <- modality_data %>% 
  pull(freq) %>%
  unique() %>% 
  mean() %>%
  log()

corpus_model_data <- modality_data %>%
  ungroup() %>%
  filter(person == "parent") %>%
  mutate(model_age = log(age) - mid_age,
         model_freq = log(freq) - mid_freq)


parent_both_raw <- glmer(cbind(both, speech + gesture) ~ model_age * model_freq + 
                    (1 | referent) + ( model_freq | subj), 
      data = corpus_model_data, 
      family = "binomial") 

parent_both_lm <- parent_both_raw %>%
  tidy() %>%
  filter(effect == "fixed") %>%
  select(-effect, -group) %>%
  mutate(p.value = printp(p.value))

walk2(c("corpus_age", "corpus_freq", "corpus_interaction"),
      c("model_age", "model_freq", "model_age:model_freq"),
      ~make_text_vars(parent_both_lm, .x, .y))
```

```{r in-data}
predicted_both <- model.frame(parent_both_raw) %>%
  as_tibble() %>%
  mutate(prop = inv.logit(predict(parent_both_raw, ., re.form = NA))) %>%
  clean_names() %>%
  rowwise() %>%
  mutate(in_prop = cbind_both_speech_gesture[1]/sum(cbind_both_speech_gesture)) %>%
  group_by(model_age, model_freq, subj, referent) %>%
  summarise(prop = mean(prop)) %>%
  summarise(prop = mean(prop)) %>%
  summarise(prop = mean(prop)) %>%
  ungroup() %>%
  left_join(corpus_model_data %>% 
              select(age, model_age, freq, model_freq) %>%
              distinct(),
            by = c("model_age","model_freq")) %>%
  mutate(plot_age = factor(age, labels = c('14 mo.', '18 mo.','22 mo.', 
                                      '26 mo.', "30 mo.",
                                      "34 mo.")))

```

These corpus data were analyzed using a mixed effects regression to predict parents' use of ostensive labeling for a given referent. The model included fixed effects of age in months, frequency of the referent, and the interaction between the two. The model included a random intercept and random slope of frequency by subject and a random intercept for each unique referent. Frequency and age were both log-scaled and then centered both because age and frequency tend to have log-linear effects and to help with model convergence. The model showed that parents use ostensive labeling less with older children ($\beta =$  `r corpus_age_estimate`, $t =$  `r corpus_age_statistic`, $p$ `r corpus_age_p.value`) and  marginally less for more frequent referents ($\beta =$  `r corpus_freq_estimate`, $t =$  `r corpus_freq_statistic`, $p =$ `r corpus_freq_p.value`). In addition, the interaction between the two was significant, indicating that for parents ostensively label more for younger children when referents are infrequent ($\beta =$  `r corpus_interaction_estimate`, $t =$  `r corpus_interaction_statistic`, $p =$ `r corpus_interaction_p.value`). Thus, in these data, we see early evidence that parents are providing richer, structured input about rarer things in the world for their younger children (Figure \ref{fig:corpus-plot}).

```{r plot-setup}
plot_data <- modality_data %>%
  group_by(person, age, subj, freq_cut, referent) %>%
  gather(modality, n, both, gesture, speech) %>%
  mutate(prop = n/sum(n)) %>%
  ungroup() %>%
  filter(modality == "both", person == "parent") %>%
  mutate(plot_age = factor(age, labels = c('14 mo.', '18 mo.','22 mo.', 
                                      '26 mo.', "30 mo.",
                                      "34 mo.")))

#set gradient
cc <- scales::seq_gradient_pal("#87d868", "#124200", "Lab")(seq(0,1,length.out=6))
cc[[6]] <- "#000000"
teaching_ribbons <- scales::seq_gradient_pal("#cbffb7", "#124200", "Lab")(seq(0,1,length.out=6))
teaching_ribbons[[6]] <- "#000000"
```

```{r corpus-plot, fig.height=4, fig.width = 6, fig.cap = "Parents' rate of ostensive labelling via multi-modal reference. Parents used ostensive labeling more for younger children and infrequent referents. Lines show model predictions for each age group."}
plot_annotations <- tibble(prop= c(.18, .12, .09, .07, .055, .035),
                           plot_age = c("14 mo.", "18 mo.","22 mo.", 
                                      '26 mo.', "30 mo.",
                                      "34 mo."),
                           freq = .7)

plot_data %>% 
  group_by(freq_cut, plot_age, subj) %>%
  summarise(prop = mean(prop)) %>%
  summarise(prop = mean(prop)) %>%
  mutate(freq_cut = exp(freq_cut)) %>%
  rename(freq  = freq_cut) %>%
  ggplot(aes(x = log(freq), y = prop, color = plot_age, 
             fill = plot_age, label = plot_age)) +
  geom_jitter(width = .1, height = 0) +
  geom_smooth(method = "loess", formula = "y ~ x", se = FALSE, data = predicted_both) + 
  labs(y="Ostensive Labeling (prop.)", x='Referent frequency (log)') +
  coord_cartesian(ylim=c(0,.2), xlim=c(-.5,6)) +
  scale_fill_manual(values = teaching_ribbons, name='Child\'s age') +
  scale_color_manual(values = teaching_ribbons, name='Child\'s age') +
  theme(legend.position = "none", aspect.ratio = 1/1.66) +
  geom_text(data = plot_annotations)
```

## Discussion

Caregivers are not indiscriminate in their use of multi-modal reference; in these data, they provided more of this support when their child was younger and when discussing less familiar objects. These longitudinal corpus findings are consistent with an account of parental alignment: parents are sensitive to their child's linguistic knowledge and adjust their communication accordingly [@yurovsky2016]. Ostensive labeling is perhaps the most explicit form of pedagogical support, so we chose to focus on it for our case study. We argue that these data could be explained by a simple, potentially-selfish pressure: to communicate successfully. The influence of communicative pressure is difficult to draw in naturalistic data, so we developed a paradigm to try to experimentally induce richly-structured, aligned input from a pressure to communicate in the moment.
