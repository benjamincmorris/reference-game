# Corpus Analysis
```{r corpus-data}
# Plot of Referential Communication from LDP Corpus Data
corpus_data <- read_feather(here("data/coded_responses.feather")) %>%
  mutate(freq_cut = cut(log(freq), 4))%>%
  separate(freq_cut, into = c("freq_cut_left", "freq_cut_right"), sep = ",",
           remove = FALSE) %>%
  mutate(freq_cut_left = as.numeric(str_remove_all(freq_cut_left,"\\(")),
         freq_cut_right = as.numeric(str_remove_all(freq_cut_right,"\\]")),
         freq_cut = (freq_cut_left + freq_cut_right)/2) %>%
  select(-freq_cut_left, -freq_cut_right)

modality_data <- corpus_data %>%
  group_by(person, age, subj, freq_cut, rank, freq, referent, modality, chat) %>%
  summarise(n = n()) %>%
  spread(modality, n, fill = 0)
```

We first investigate parents' use of ostensive labeling in referential communication in a longitudinal corpus of parent-child interaction. Ostensive labeling--the behavior pointing to and labeling an object with its name--is a powerful source of information for word learning because it reduces the ambiguity about the possible meanings of the word the child is hearing. The word could of course still have many possible meanings--it could refer to a part of the object, or something about it's state for instance, but it is unlikely to refer to one of the other objects in the room [@quine1960]. Prior work has shown that parents tend to use ostensive labeling when referring to objects with basic level words [e.g. "chair", "dog", @callanan1985, @ninio1980], and that ostensive labeling is a particularly powerful source of data for young children [e.g., @baldwin2000; @gogate2000]. We take the ostensive labeling with multi-modal cues to be a case-study phenomenon of pedagogically supportive language input. While our account should hold for other language phenomena, by focusing on one phenomenon we attempt to specify the dynamics involved in the production of such input.

In this analysis of naturalistic communication, we examine the prevalence of ostensive labeling in children's language environment at different ages. We find that this pedagogically-supportive form of input shows a key hallmark of adaptive tuning: caregivers using this information-rich cue more for young children and infrequent objects. Thus, parents' production of ostensive labeling is tuned to children's developing linguistic knowledge [@yurovsky2016]. 

## Methods

We used data from the Language Development Project--a large-scale, longitudinal corpus of naturalistic parent child-interaction in the home [@goldin-meadow2014]. The Language Development Project corpus contains transcription of all speech and communicative gestures produced by children and their caregivers over the course of the 90-minute home recordings. We coded each of these communicative instances to identify each time a concrete noun was referenced using speech, gesture, or both in the same referential expression (so called ostensive labeling). In these analyses, we focus on caregivers' productions of ostensive labeling in the form of a multi-modal reference.


### Participants

The Language Development Project aimed to recruit a sample of families who are representative of the Chicago community in socio-economic and racial diversity [@goldin-meadow2014]. These data are drawn from a subsample of 10 families from the larger corpus. Our subsample contains data taken in the home every 4-months from when the child was 14-months-old until they were 34-months-old, resulting in 6 timepoints (missing one family at the 30-month timepoint). Recordings were 90 minute sessions, and participants were given no instructions.

Of the ten target children, five were girls, three were Black and two were Mixed-Race. Families spanned a broad range of incomes, with two families earning \$15,000 to \$34,999 and 1 family earning greater than \$100,000. The median family income was \$50,000 to \$74,999.

### Procedure

From the extant transcription and gesture coding, we specifically coded all concrete noun referents produced in either the spoken or gestural modality (or both). Spoken reference was coded only when a specific noun form was used (e.g., "ball"), to exclude pronouns and anaphoric usages (e.g., "it"). Gesture reference was coded only for deictic gestures (e.g., pointing to or holding an object up for view) to minimize ambiguity in determining the intended referent. In order to fairly compare rates of communication across modalities, we need to examine concepts that can be referred to in either gesture or speech (or both) with similar ease. Because abstract entities are difficult to gesture about using deictic gestures, we coded only references to concrete nouns. 

### Reliability

To establish the reliability of the referent coding, 25% of the transcripts were double-coded. Inter-rater reliability was sufficiently high (Cohenâ€™s $\kappa$ = 0.76). Disagreements in coding decisions were discussed and resolved by hand.

To ensure that our each referent could potentially be referred to in gesture or speech, we focused on concrete nouns. We further wanted to ensure that the referents were physically present in the scene (and thus available for deictic gestures). Using the transcripts, a human rater judged whether the referent was likely to be present, primarily relying on discourse context (e.g., a referent was coded as present if the deictic gesture is used or used at another timepoint for the reference, or if the utterance included demonstratives such as "This is an X"). A full description of the coding criteria can be found in the Supporting Materials.

To ensure our transcript-based coding of referent presence was sufficiently accurate, a subset of the transcripts (5%) were directly compared to corresponding video data observation. Reliability across the video data and the transcript coding was sufficiently high ($\kappa$ = 0.72). Based on transcript coding of all the referential communication about concrete nouns, 90% of the references were judged to be about referents that were likely present. All references are available in the open access dataset for further analysis.

## Results

```{r corpus-plot-lm}
corpus_model_data <- modality_data %>%
  ungroup() %>%
  filter(person == "parent") %>%
  mutate(model_age = scale(log(age), scale = FALSE),
         model_freq = scale(log(freq), scale = FALSE))


parent_both_raw <- glmer(cbind(both, speech + gesture) ~ 
                           model_age * model_freq + 
                    (1 | referent) + ( model_freq | subj), 
      data = corpus_model_data, 
      family = "binomial") 

parent_both_lm <- parent_both_raw %>%
  tidy() %>%
  filter(effect == "fixed") %>%
  select(-effect, -group) %>%
  mutate(p.value = printp(p.value))

walk2(c("corpus_age", "corpus_freq", "corpus_interaction"),
      c("model_age", "model_freq", "model_age:model_freq"),
      ~make_text_vars(parent_both_lm, .x, .y))
```

```{r in-data, eval = FALSE}
predicted_both <- model.frame(parent_both_raw) %>%
  as_tibble() %>%
  clean_names() %>%
  mutate(prop = inv.logit(predict(parent_both_raw, re.form = NA, .))) %>%
  rowwise() %>%
  mutate(in_prop = cbind_both_speech_gesture[1]/
           sum(cbind_both_speech_gesture)) %>%
  group_by(model_age, model_freq, subj, referent) %>%
  summarise(prop = mean(prop), in_prop = mean(in_prop)) %>%
  summarise(prop = mean(prop), in_prop = mean(in_prop)) %>%
  summarise(prop = mean(prop), in_prop = mean(in_prop)) %>%
  ungroup() %>%
   left_join(corpus_model_data %>% 
              select(age, model_age, freq, model_freq) %>%
              distinct(),
            by = c("model_age","model_freq")) %>%
  mutate(plot_age = factor(age, labels = c('14 mo.', '18 mo.','22 mo.', 
                                      '26 mo.', "30 mo.",
                                      "34 mo.")))
```

Corpus data were analyzed using a mixed effects regression to predict parents' use of ostensive labeling for a given referent. The model included fixed effects of age in months, frequency of the referent, and the interaction between the two. The model included a random intercept and random slope of frequency by subject and a random intercept for each unique referent. Frequency and age were both log-scaled and then centered both because age and frequency tend to have log-linear effects and to help with model convergence. The model showed that parents use ostensive labeling less with older children ($\beta =$  `r corpus_age_estimate`, $p$ `r corpus_age_p.value`) and less for more frequent referents ($\beta =$  `r corpus_freq_estimate`, $p =$ `r corpus_freq_p.value`). In addition, the interaction between the two was significant, indicating that for parents ostensively label more for younger children when referents are infrequent ($\beta =$  `r corpus_interaction_estimate`, $p =$ `r corpus_interaction_p.value`). Thus, in these data, we evidence that parents provide more pedagogically-supportive input about rarer things in the world for their younger children (Figure \ref{fig:corpus-plot}).

```{r plot-setup}
plot_data <- modality_data %>%
  group_by(person, age, subj, freq_cut, referent) %>%
  pivot_longer(cols = c(both, gesture, speech), 
               names_to = "modality", values_to = "n") %>%
  mutate(prop = n/sum(n)) %>%
  ungroup() %>%
  filter(modality == "both", person == "parent") %>%
  mutate(plot_age = factor(age, labels = c('14 mo.', '18 mo.','22 mo.', 
                                      '26 mo.', "30 mo.",
                                      "34 mo.")))

ci_funs <- list("ci_lower" = ci_lower, "ci_upper" = ci_upper)
new_plot_data <- plot_data %>%
  group_by(age, freq_cut, subj, referent) %>%
  summarise(prop = mean(prop), n = n()) %>%
  summarise(prop = weighted.mean(prop, w = n), n = n()) %>%
  tidyboot(summary_function = function(x) x %>%
             summarise(stat = weighted.mean(prop, n)),
           statistics_functions = function(x) x %>%
             summarise(across(stat, ci_funs, .names = "{.fn}"))) %>%
  rename(prop = empirical_stat)

#set gradient
cc <- scales::seq_gradient_pal("#87d868", "#124200", "Lab")(seq(0,1,length.out=6))
cc[[6]] <- "#000000"
teaching_ribbons <- scales::seq_gradient_pal("#cbffb7", "#124200", "Lab")(seq(0,1,length.out=6))
teaching_ribbons[[6]] <- "#000000"
```

```{r corpus-plot, fig.height=4, fig.width = 6, fig.cap = "Parents' rate of ostensive labelling via multi-modal reference for referents of varying frequency. Log frequences were binned into quartiles for visualization. Points show empirical frequencies along with 95\\% confidence intervals computed by non-parametric bootstrapping. Lines show estimates from a logisitic regression along with ribbons indicating one standard error. Parents used ostensive labeling more for younger children and infrequent referents. "}
plot_annotations <- tibble(prop= c(.18, .11, .06, .05, .04, .02),
                           age = c(14, 18, 26,  30, 22, 34),
                           label = glue("{age} mo."),
                           freq_cut = .35)

ggplot(new_plot_data, aes(x = freq_cut, y = prop, color = as.factor(age),
                          fill = as.factor(age), group = as.factor(age))) + 
  geom_smooth(method = "lm", formula = "y ~ log(x)", 
              position = position_dodge(.5), data = plot_data,
              alpha = .25) +
  geom_pointrange(aes(ymin = ci_lower, ymax = ci_upper),
                  position = position_dodge(.5)) +
  scale_fill_viridis_d() +
  scale_color_viridis_d() +
  geom_text(aes(label = label), data = plot_annotations) +
  coord_cartesian(ylim=c(0,.31), xlim=c(.2,7)) +
  labs(y="Ostensive Labeling (prop.)", 
       x="Referent (log) frequency quartile") +
  theme(legend.position = "none", aspect.ratio = 1/1.66) +
  scale_x_continuous(breaks = seq(1,7,2), labels = 1:4)
```

## Discussion

Caregivers are not indiscriminate in their use of ostensive labeling; in these data, they provided more of this support when their child was younger and when discussing less familiar objects. These longitudinal corpus findings are consistent with an account of caregiver alignment: parents are sensitive to their child's linguistic knowledge and adjust their communication accordingly [@yurovsky2016].

This caregiver alignment is straightforwardly predicted from a dyadic perspective that privileges communicative goals, yet wholly missing from learner-centric accounts of language learning [@yurovsky2018] . While some early accounts of language learning suggested a important role for caregiver tuning of linguistic input [e.g., @snow1972], these accounts fell out of favor in light of influential investigations that did not find tuning of syntactic structure [@newport1977]. However, this work, along with other recent papers, shows that caregivers may be well calibrated to their children's semantic knowledge and this tuning may be quite relevant for language problems like word learning where communicative success is central [e.g., @yurovsky2016, @leung2021].

While language input that is tuned to the child's linguistic competence could undoubtedly aid in language learning, the presence of such input does not necessarily imply pedagogical goals. These data could potentially be explained by a simpler, less altruistic goal: to communicate successfully. Because we do not have access to parents' goals, we these data alone cannot distinguish between these competing accounts not can they determine whether word frequency and children's linguistic knowledge are *causally* related to the use of ostensive labeling. To demonstrate that communicative pressure alone is sufficient to explain these patterns in ostensive labeling, we next developed an experimental paradigm to study these and other factors in a controllable model system. 